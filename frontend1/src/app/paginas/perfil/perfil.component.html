<app-navbar></app-navbar>

<main class="max-w-2xl mx-auto px-4 py-12">
  <h2 class="text-2xl font-bold mb-6 text-center">
    {{ "PROFILE.HEADER" | translate : { name: usuario?.nombre } }}
  </h2>

  <div class="space-y-4" id="accordion">
    <!-- Secci√≥n Perfil -->
  <details open class="border rounded-md p-4">
    <summary class="cursor-pointer font-semibold text-lg">
      {{ "PROFILE.SECTION_PERFIL" | translate }}
    </summary>

    <form
      #perfilForm="ngForm"
      (ngSubmit)="guardarCambios()"
      class="space-y-6"
      novalidate
    >
      <!-- Foto de perfil: sin cambios -->

      <!-- Nombre -->
      <div>
        <label class="block text-sm font-medium text-gray-700">
          {{ "PROFILE.LABEL_NOMBRE" | translate }}
        </label>
        <input
          type="text"
          name="nombre"
          [(ngModel)]="usuario.nombre"
          #nombre="ngModel"
          required
          minlength="3"
          class="w-full border rounded-lg px-4 py-2 focus:outline-none"
          [ngClass]="{
            'border-red-500': nombre.invalid && nombre.touched,
            'focus:ring-green-400 focus:border-green-400':
              nombre.valid && nombre.touched
          }"
        />
        <div *ngIf="nombre.touched && nombre.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="nombre.errors?.required">
            {{ "PROFILE.ERROR_NOMBRE_REQUIRED" | translate }}
          </div>
          <div *ngIf="nombre.errors?.minlength">
            {{ "PROFILE.ERROR_NOMBRE_MINLENGTH" | translate:{ min: 3 } }}
          </div>
        </div>
      </div>

      <!-- Correo -->
      <div>
        <label class="block text-sm font-medium text-gray-700">
          {{ "PROFILE.LABEL_CORREO" | translate }}
        </label>
        <input
          type="email"
          name="email"
          [(ngModel)]="usuario.email"
          #email="ngModel"
          required
          email
          class="w-full border rounded-lg px-4 py-2 focus:outline-none"
          [ngClass]="{
            'border-red-500': email.invalid && email.touched,
            'focus:ring-green-400 focus:border-green-400':
              email.valid && email.touched
          }"
        />
        <div *ngIf="email.touched && email.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="email.errors?.['required']">
            {{ "PROFILE.ERROR_EMAIL_REQUIRED" | translate }}
          </div>
          <div *ngIf="email.errors?.['email']">
            {{ "PROFILE.ERROR_EMAIL_INVALID" | translate }}
          </div>
        </div>
      </div>

      <!-- Tel√©fono -->
      <div>
        <label class="block text-sm font-medium text-gray-700">
          {{ "PROFILE.LABEL_TELEFONO" | translate }}
        </label>
        <input
          type="text"
          name="telefono"
          [(ngModel)]="usuario.telefono"
          #telefono="ngModel"
          required
          pattern="^[0-9]{9}$"
          class="w-full border rounded-lg px-4 py-2 focus:outline-none"
          [ngClass]="{
            'border-red-500': telefono.invalid && telefono.touched,
            'focus:ring-green-400 focus:border-green-400':
              telefono.valid && telefono.touched
          }"
        />
        <div *ngIf="telefono.touched && telefono.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="telefono.errors?.['required']">
            {{ "PROFILE.ERROR_TELEFONO_REQUIRED" | translate }}
          </div>
          <div *ngIf="telefono.errors?.['pattern']">
            {{ "PROFILE.ERROR_TELEFONO_PATTERN" | translate }}
          </div>
        </div>
      </div>

      <!-- Bot√≥n guardar: queda igual -->
      <button
        type="submit"
        class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded-lg transition"
        [disabled]="perfilForm.invalid"
      >
        {{ "PROFILE.BUTTON_GUARDAR" | translate }}
      </button>
    </form>
  </details>

    <!-- Secci√≥n Citas -->
    <details class="border rounded-md p-4 shadow-sm">
      <summary class="cursor-pointer font-semibold text-lg">
        {{ "PROFILE.SECTION_CITAS" | translate }}
      </summary>
      <h3 class="text-xl font-semibold my-4 text-center text-[#117B95]">
        {{ "PROFILE.MIS_CITAS" | translate }}
      </h3>

      <div *ngIf="citas.length > 0; else sinCitas" class="space-y-6">
        <div
          *ngFor="let cita of citas"
          class="p-5 bg-gray-50 border border-gray-200 rounded-lg shadow hover:shadow-md transition-shadow"
        >
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <p>
              <strong>üìÖ {{ "PROFILE.LABEL_FECHA" | translate }}:</strong>
              {{ cita.fecha }}
            </p>
            <p>
              <strong>‚è∞ {{ "PROFILE.LABEL_HORA" | translate }}:</strong>
              {{ cita.hora }}
            </p>
            <p>
              <strong>üíà {{ "PROFILE.LABEL_SERVICIO" | translate }}</strong>
              {{
                serviciosMap[cita.id_servicio] ||
                  ("PROFILE.LOADING" | translate)
              }}
            </p>

            <ng-container *ngIf="esDuenoOSuper(cita); else mostrarSoloEstado">
              <div>
                <label class="block text-sm font-medium text-gray-700">
                  {{ "PROFILE.LABEL_ESTADO" | translate }} :
                </label>
                <select
                  [(ngModel)]="cita.estado"
                  (change)="onCambiarEstado(cita, $any($event.target).value)"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-[#117B95] focus:outline-none"
                  name="estadoCita{{ cita.id_cita }}"
                >
                  <option value="pendiente">
                    {{ "PROFILE.ESTADO.PENDIENTE" | translate }}
                  </option>
                  <option value="confirmada">
                    {{ "PROFILE.ESTADO.CONFIRMADA" | translate }}
                  </option>
                  <option value="cancelada">
                    {{ "PROFILE.ESTADO.CANCELADA" | translate }}
                  </option>
                </select>
              </div>
            </ng-container>
            <ng-template #mostrarSoloEstado>
              <p>
                <strong>{{ "PROFILE.LABEL_ESTADO" | translate }}:</strong>
                {{ "PROFILE.ESTADO." + (cita.estado | uppercase) | translate }}
              </p>
            </ng-template>

            <ng-container *ngIf="esDuenoOSuper(cita); else mostrarSoloEmpleado">
              <div>
                <label class="block text-sm font-medium text-gray-700">
                  {{ "PROFILE.LABEL_EMPLEADO_ASIGNADO" | translate }}
                  :</label
                >
                <select
                  (change)="onCambiarEmpleado(cita, +$any($event.target).value)"
                  [ngModel]="cita.id_empleado"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-[#117B95] focus:outline-none"
                  name="empleadoCita{{ cita.id_cita }}"
                >
                  <option
                    *ngFor="
                      let emp of empleadosPorSalon[citaSalonMap[cita.id_cita]]
                    "
                    [value]="emp.id_empleado"
                  >
                    {{ emp.nombre }}
                  </option>
                </select>
              </div>
            </ng-container>
            <ng-template #mostrarSoloEmpleado>
              <p>
                <strong>{{ "PROFILE.LABEL_EMPLEADO" | translate }}:</strong>
                {{
                  empleadosMap[cita.id_empleado] ||
                    ("PROFILE.LOADING" | translate)
                }}
              </p>
            </ng-template>
          </div>

          <!-- Bot√≥n eliminar -->
          <div class="mt-4 text-right">
            <button
              class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm transition"
              (click)="onEliminarCita(cita)"
            >
              üóë {{ "PROFILE.BUTTON_ELIMINAR_CITA" | translate }}
            </button>
          </div>
        </div>
      </div>

      <ng-template #sinCitas>
        <p class="text-center text-gray-500 italic mt-4">
          {{ "PROFILE.NO_CITAS" | translate }}
        </p>
      </ng-template>
    </details>

    <!-- Secci√≥n Sal√≥n -->
    <details
      class="border rounded-md p-4 shadow-sm transition-all duration-300 ease-in-out"
    >
      <summary class="cursor-pointer font-semibold text-lg">
        {{ "PROFILE.SECTION_SALON" | translate }}
      </summary>

      <h3 class="text-xl font-semibold my-6 text-center text-[#117B95]">
        {{ "PROFILE.MIS_SALONES" | translate }}
      </h3>

      <div *ngIf="misSalones.length > 0; else sinSalon" class="space-y-6">
        <div
          *ngFor="let salon of misSalones"
          class="p-6 bg-white border border-gray-200 rounded-xl shadow hover:shadow-md transition animate-fade-in"
        >
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <p>
              <strong>{{ "PROFILE.LABEL_NOMBRE_SALON" | translate }}:</strong>
              {{ salon.nombre }}
            </p>
            <p>
              <strong>{{ "PROFILE.LABEL_DIRECCION" | translate }}:</strong>
              {{ salon.direccion }}
            </p>
            <p>
              <strong>{{ "PROFILE.LABEL_TELEFONO_SALON" | translate }}:</strong>
              {{ salon.telefono }}
            </p>
            <p>
              <strong>{{ "PROFILE.LABEL_HORARIO" | translate }}:</strong>
              {{ salon.horario_apertura }} - {{ salon.horario_cierre }}
            </p>
            <p class="md:col-span-2">
              <strong>{{ "PROFILE.LABEL_DESCRIPCION" | translate }}:</strong>
              {{ salon.descripcion }}
            </p>
          </div>

          <div class="mt-4 flex flex-wrap gap-2 justify-end">
            <button
              *ngIf="
                usuario.rol === 'administrador' ||
                usuario.id_usuario === salon.id_usuario
              "
              class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded transition"
              (click)="editarSalon(salon)"
            >
              {{ "PROFILE.BUTTON_EDITAR_SALON" | translate }}
            </button>
            <button
              *ngIf="
                usuario.rol === 'administrador' ||
                usuario.id_usuario === salon.id_usuario
              "
              class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded transition"
              (click)="borrarSalon(salon)"
            >
              {{ "PROFILE.BUTTON_BORRAR_SALON" | translate }}
            </button>
            <button
              *ngIf="
                usuario.rol === 'administrador' ||
                usuario.id_usuario === salon.id_usuario
              "
              class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition"
              (click)="abrirFormularioCrearServicio(salon.id_salon)"
            >
              {{ "PROFILE.BUTTON_AGREGAR_SERVICIO" | translate }}
            </button>
          </div>

          <!-- LISTA DE SERVICIOS -->
          <div class="mt-6">
            <h4 class="text-lg font-semibold mb-2">
              {{ "PROFILE.LABEL_SERVICIOS" | translate }}
            </h4>
            <div
              *ngIf="
                serviciosPorSalon[salon.id_salon] &&
                  serviciosPorSalon[salon.id_salon].length > 0;
                else sinServicios
              "
              class="space-y-3"
            >
              <div
                *ngFor="let serv of serviciosPorSalon[salon.id_salon]"
                class="p-3 border border-gray-200 rounded-lg flex justify-between items-start bg-gray-50"
              >
                <div>
                  <p>
                    <strong>{{ serv.nombre }}</strong> ({{
                      serv.duracion_minutos
                    }}
                    min) - ‚Ç¨{{ serv.precio }}
                  </p>
                  <p class="text-sm text-gray-600">{{ serv.descripcion }}</p>
                </div>
                <div class="flex gap-2">
                  <button
                    class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-sm"
                    (click)="abrirFormularioEditarServicio(serv)"
                  >
                    {{ "PROFILE.BUTTON_EDITAR_SERVICIO" | translate }}
                  </button>
                  <button
                    class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm"
                    (click)="borrarServicio(serv)"
                  >
                    {{ "PROFILE.BUTTON_BORRAR_SERVICIO" | translate }}
                  </button>
                </div>
              </div>
            </div>
            <ng-template #sinServicios>
              <p class="text-gray-500 italic">
                {{ "PROFILE.SIN_SERVICIOS" | translate }}
              </p>
            </ng-template>
          </div>

          <!-- LISTA DE EMPLEADOS -->
          <div class="mt-6">
            <h4 class="text-lg font-semibold mb-2">
              {{ "PROFILE.LABEL_EMPLEADOS" | translate }}
            </h4>
            <button
              *ngIf="
                usuario.rol === 'administrador' ||
                usuario.id_usuario === salon.id_usuario
              "
              class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-1 rounded mb-3"
              (click)="abrirFormularioCrearEmpleado(salon.id_salon)"
            >
              {{ "PROFILE.BUTTON_AGREGAR_EMPLEADO" | translate }}
            </button>

            <div
              *ngIf="
                empleadosPorSalon[salon.id_salon] &&
                  empleadosPorSalon[salon.id_salon].length > 0;
                else sinEmpleados
              "
              class="space-y-3"
            >
              <div
                *ngFor="let emp of empleadosPorSalon[salon.id_salon]"
                class="p-3 border border-gray-200 rounded-lg flex items-center justify-between bg-gray-50"
              >
                <div class="flex items-center gap-4">
                  <img
                    *ngIf="emp.foto"
                    [src]="emp.foto"
                    alt="Foto {{ emp.nombre }}"
                    class="w-12 h-12 rounded-full object-cover"
                  />
                  <div>
                    <p class="font-medium">{{ emp.nombre }}</p>
                    <p class="text-sm text-gray-600">
                      Tel.: {{ emp.telefono }}
                    </p>
                  </div>
                </div>
                <div class="flex gap-2">
                  <button
                    class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded text-sm"
                    (click)="abrirFormularioEditarEmpleado(emp)"
                  >
                    {{ "PROFILE.BUTTON_EDITAR_EMPLEADO" | translate }}
                  </button>
                  <button
                    class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm"
                    (click)="borrarEmpleado(emp)"
                  >
                    {{ "PROFILE.BUTTON_BORRAR_EMPLEADO" | translate }}
                  </button>
                </div>
              </div>
            </div>
            <ng-template #sinEmpleados>
              <p class="text-gray-500 italic">
                {{ "PROFILE.SIN_EMPLEADOS" | translate }}
              </p>
            </ng-template>
          </div>
        </div>
      </div>

      <ng-template #sinSalon>
        <p class="text-center text-gray-500 italic mt-4">
          {{ "PROFILE.NO_SALON" | translate }}
        </p>
      </ng-template>
    </details>

    <!-- Secci√≥n Cerrar Sesi√≥n -->
    <details
      class="border rounded-md p-4 shadow-sm transition-all duration-300 ease-in-out animate-fade-in-up"
    >
      <summary class="cursor-pointer font-semibold text-lg text-red-600">
        üîí {{ "PROFILE.SECTION_CERRAR_SESION" | translate }}
      </summary>
      <div class="mt-4 bg-red-50 border border-red-200 rounded-lg p-4">
        <p class="text-sm text-gray-700 mb-4 text-center">
          {{ "PROFILE.TEXT_CONFIRMAR_CERRAR" | translate }}
        </p>
        <div class="flex justify-center">
          <button
            (click)="logout()"
            class="bg-red-600 hover:bg-red-700 active:scale-95 text-white px-6 py-2 rounded-lg font-semibold transition transform"
          >
            {{ "PROFILE.BUTTON_SALIR_AHORA" | translate }}
          </button>
        </div>
      </div>
    </details>
  </div>
</main>

<app-footer></app-footer>

<!-- Modal de confirmaci√≥n de eliminaci√≥n de SAL√ìN -->
<div
  *ngIf="salonAEliminar"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
>
  <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
    <h3 class="text-xl font-semibold mb-4 text-red-600">
      {{ "PROFILE.MODAL_CONFIRM_TITULO" | translate }}
    </h3>
    <p class="mb-4">
      {{ "PROFILE.MODAL_CONFIRM_TEXTO" | translate }}:
      <strong>{{ salonAEliminar.nombre }}</strong>
    </p>

    <input
      type="text"
      [(ngModel)]="nombreConfirmacion"
      placeholder="{{ 'PROFILE.MODAL_CONFIRM_PLACEHOLDER' | translate }}"
      class="w-full border p-2 rounded mb-4"
      name="confirmacion"
    />

    <div class="flex justify-end gap-2">
      <button
        type="button"
        class="bg-gray-500 text-white px-4 py-2 rounded"
        (click)="cancelarEliminacion()"
      >
        {{ "PROFILE.BUTTON_CANCELAR" | translate }}
      </button>
      <button
        class="bg-red-600 text-white px-4 py-2 rounded"
        [disabled]="nombreConfirmacion !== salonAEliminar.nombre"
        (click)="confirmarEliminacion()"
      >
        {{ "PROFILE.BUTTON_ELIMINAR" | translate }}
      </button>
    </div>
  </div>
</div>

<!-- Modal para EDITAR/CREAR Sal√≥n -->
<div
  *ngIf="salonEditando"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
>
  <div class="bg-white rounded-lg p-6 w-full max-w-lg shadow-lg">
    <h3 class="text-xl font-semibold mb-4 text-center">
      {{
        salonEditando.id_salon
          ? ('PROFILE.MODAL_EDITAR_SALON_TITULO' | translate)
          : ('PROFILE.MODAL_NUEVO_SALON_TITULO' | translate)
      }}
    </h3>
    <form
      #salonForm="ngForm"
      (ngSubmit)="guardarCambiosSalon()"
      novalidate
      class="space-y-4"
    >
      <!-- Nombre -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_NOMBRE_SALON" | translate }}
        </label>
        <input
          type="text"
          name="nombreSalon"
          [(ngModel)]="salonEditando.nombre"
          #nombreSalon="ngModel"
          required
          minlength="3"
          placeholder="{{ 'PROFILE.PLACEHOLDER_NOMBRE_SALON' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          [ngClass]="{
            'border-red-500': nombreSalon.invalid && nombreSalon.touched,
            'border-green-400': nombreSalon.valid && nombreSalon.touched
          }"
        />
        <div *ngIf="nombreSalon.touched && nombreSalon.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="nombreSalon.errors?.['required']">
            {{ "PROFILE.ERROR_NOMBRE_REQUIRED" | translate }}
          </div>
          <div *ngIf="nombreSalon.errors?.['minlength']">
            {{ "PROFILE.ERROR_NOMBRE_MINLENGTH" | translate:{ min: 3 } }}
          </div>
        </div>
      </div>

      <!-- Direcci√≥n -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_DIRECCION" | translate }}
        </label>
        <input
          type="text"
          name="direccionSalon"
          [(ngModel)]="salonEditando.direccion"
          #direccionSalon="ngModel"
          required
          placeholder="{{ 'PROFILE.PLACEHOLDER_DIRECCION' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          [ngClass]="{
            'border-red-500': direccionSalon.invalid && direccionSalon.touched,
            'border-green-400': direccionSalon.valid && direccionSalon.touched
          }"
        />
        <div *ngIf="direccionSalon.touched && direccionSalon.invalid" class="text-red-600 mt-1 text-sm">
          {{ "PROFILE.ERROR_DIRECCION_REQUIRED" | translate }}
        </div>
      </div>

      <!-- Tel√©fono -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_TELEFONO_SALON" | translate }}
        </label>
        <input
          type="text"
          name="telefonoSalon"
          [(ngModel)]="salonEditando.telefono"
          #telefonoSalon="ngModel"
          required
          pattern="^[0-9]{9}$"
          placeholder="{{ 'PROFILE.PLACEHOLDER_TELEFONO_SALON' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          [ngClass]="{
            'border-red-500': telefonoSalon.invalid && telefonoSalon.touched,
            'border-green-400': telefonoSalon.valid && telefonoSalon.touched
          }"
        />
        <div *ngIf="telefonoSalon.touched && telefonoSalon.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="telefonoSalon.errors?.['required']">
            {{ "PROFILE.ERROR_TELEFONO_REQUIRED" | translate }}
          </div>
          <div *ngIf="telefonoSalon.errors?.['pattern']">
            {{ "PROFILE.ERROR_TELEFONO_PATTERN" | translate }}
          </div>
        </div>
      </div>

      <!-- Descripci√≥n -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_DESCRIPCION" | translate }}
        </label>
        <textarea
          name="descripcionSalon"
          [(ngModel)]="salonEditando.descripcion"
          #descripcionSalon="ngModel"
          required
          minlength="10"
          placeholder="{{ 'PROFILE.PLACEHOLDER_DESCRIPCION' | translate }}"
          rows="2"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          [ngClass]="{
            'border-red-500': descripcionSalon.invalid && descripcionSalon.touched,
            'border-green-400': descripcionSalon.valid && descripcionSalon.touched
          }"
        ></textarea>
        <div *ngIf="descripcionSalon.touched && descripcionSalon.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="descripcionSalon.errors?.['required']">
            {{ "PROFILE.ERROR_DESCRIPCION_REQUIRED" | translate }}
          </div>
          <div *ngIf="descripcionSalon.errors?.['minlength']">
            {{ "PROFILE.ERROR_DESCRIPCION_MINLENGTH" | translate:{ min: 10 } }}
          </div>
        </div>
      </div>

      <!-- Especializaci√≥n -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_ESPECIALIZACION" | translate }}
        </label>
        <input
          type="text"
          name="especializacionSalon"
          [(ngModel)]="salonEditando.especializacion"
          #especializacionSalon="ngModel"
          required
          minlength="3"
          placeholder="{{ 'PROFILE.PLACEHOLDER_ESPECIALIZACION' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          [ngClass]="{
            'border-red-500': especializacionSalon.invalid && especializacionSalon.touched,
            'border-green-400': especializacionSalon.valid && especializacionSalon.touched
          }"
        />
        <div *ngIf="especializacionSalon.touched && especializacionSalon.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="especializacionSalon.errors?.['required']">
            {{ "PROFILE.ERROR_ESPECIALIZACION_REQUIRED" | translate }}
          </div>
          <div *ngIf="especializacionSalon.errors?.['minlength']">
            {{ "PROFILE.ERROR_ESPECIALIZACION_MINLENGTH" | translate:{ min: 3 } }}
          </div>
        </div>
      </div>

      <!-- Foto -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_FOTO_SALON" | translate }}
        </label>
        <input
          type="file"
          (change)="onFileSelected($event, 'salon')"
          accept="image/*"
          class="w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
        />
      </div>
      <div *ngIf="previewUrlSalon" class="mt-2 text-center">
        <img
          [src]="previewUrlSalon"
          alt="Vista previa del sal√≥n"
          class="rounded-xl w-full object-cover h-48 max-h-48 shadow-md"
        />
      </div>

      <!-- Botones -->
      <div class="flex justify-end space-x-2 pt-4">
        <button
          type="button"
          class="bg-gray-500 text-white px-4 py-2 rounded"
          (click)="cerrarModalSalon()"
        >
          {{ "PROFILE.BUTTON_CANCELAR" | translate }}
        </button>
        <button
          type="submit"
          [disabled]="salonForm.invalid"
          class="bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50"
        >
          {{
            salonEditando.id_salon
              ? ('PROFILE.BUTTON_ACTUALIZAR_SALON' | translate)
              : ('PROFILE.BUTTON_GUARDAR_SALON' | translate)
          }}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal CREAR SERVICIO -->
<div
  *ngIf="showFormCrear"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
>
  <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
    <h3 class="text-xl font-semibold mb-4 text-center">
      {{ "PROFILE.MODAL_NUEVO_SERVICIO_TITULO" | translate }}
    </h3>
    <form
      #servicioForm="ngForm"
      (ngSubmit)="guardarServicioNuevo()"
      novalidate
      class="space-y-4"
    >
      <!-- Nombre -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_SERVICIO_NOMBRE" | translate }}
        </label>
        <input
          type="text"
          name="nombreNuevo"
          [(ngModel)]="servicioNuevo.nombre"
          #nombreNuevo="ngModel"
          required
          placeholder="{{ 'PROFILE.PLACEHOLDER_SERVICIO_NOMBRE' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
          [ngClass]="{
            'border-red-500': nombreNuevo.invalid && nombreNuevo.touched,
            'border-green-400': nombreNuevo.valid && nombreNuevo.touched
          }"
        />
        <div *ngIf="nombreNuevo.touched && nombreNuevo.invalid" class="text-red-600 mt-1 text-sm">
          {{ "PROFILE.ERROR_NOMBRE_REQUIRED" | translate }}
        </div>
      </div>

      <!-- Descripci√≥n -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_SERVICIO_DESCRIPCION" | translate }}
        </label>
        <textarea
          name="descripcionNuevo"
          [(ngModel)]="servicioNuevo.descripcion"
          #descripcionNuevo="ngModel"
          minlength="5"
          placeholder="{{ 'PROFILE.PLACEHOLDER_SERVICIO_DESCRIPCION' | translate }}"
          rows="2"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
          [ngClass]="{
            'border-red-500': descripcionNuevo.invalid && descripcionNuevo.touched,
            'border-green-400': descripcionNuevo.valid && descripcionNuevo.touched
          }"
        ></textarea>
        <div *ngIf="descripcionNuevo.touched && descripcionNuevo.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="descripcionNuevo.errors?.['minlength']">
            {{ "PROFILE.ERROR_DESCRIPCION_MINLENGTH" | translate:{ min: 5 } }}
          </div>
        </div>
      </div>

      <!-- Precio -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_SERVICIO_PRECIO" | translate }}
        </label>
        <input
          type="number"
          name="precioNuevo"
          [(ngModel)]="servicioNuevo.precio"
          #precioNuevo="ngModel"
          required
          min="1"
          placeholder="{{ 'PROFILE.PLACEHOLDER_SERVICIO_PRECIO' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
          [ngClass]="{
            'border-red-500': precioNuevo.invalid && precioNuevo.touched,
            'border-green-400': precioNuevo.valid && precioNuevo.touched
          }"
        />
        <div *ngIf="precioNuevo.touched && precioNuevo.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="precioNuevo.errors?.['required']">
            {{ "PROFILE.ERROR_PRECIO_REQUIRED" | translate }}
          </div>
          <div *ngIf="precioNuevo.errors?.['min']">
            {{ "PROFILE.ERROR_PRECIO_MIN" | translate:{ min: 1 } }}
          </div>
        </div>
      </div>

      <!-- Duraci√≥n -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_SERVICIO_DURACION" | translate }}
        </label>
        <input
          type="number"
          name="duracionNuevo"
          [(ngModel)]="servicioNuevo.duracion_minutos"
          #duracionNuevo="ngModel"
          required
          min="1"
          placeholder="{{ 'PROFILE.PLACEHOLDER_SERVICIO_DURACION' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
          [ngClass]="{
            'border-red-500': duracionNuevo.invalid && duracionNuevo.touched,
            'border-green-400': duracionNuevo.valid && duracionNuevo.touched
          }"
        />
        <div *ngIf="duracionNuevo.touched && duracionNuevo.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="duracionNuevo.errors?.['required']">
            {{ "PROFILE.ERROR_DURACION_REQUIRED" | translate }}
          </div>
          <div *ngIf="duracionNuevo.errors?.['min']">
            {{ "PROFILE.ERROR_DURACION_MIN" | translate:{ min: 1 } }}
          </div>
        </div>
      </div>

      <!-- Botones -->
      <div class="flex justify-end space-x-2 pt-4">
        <button
          type="button"
          class="bg-gray-500 text-white px-4 py-2 rounded"
          (click)="cerrarFormularioServicio()"
        >
          {{ "PROFILE.BUTTON_CANCELAR" | translate }}
        </button>
        <button
          type="submit"
          [disabled]="servicioForm.invalid"
          class="bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50"
        >
          {{ "PROFILE.BUTTON_GUARDAR_SERVICIO" | translate }}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal CREAR EMPLEADO -->
<div
  *ngIf="showFormCrearEmpleado"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
>
  <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
    <h3 class="text-xl font-semibold mb-4 text-center">
      {{ "PROFILE.MODAL_NUEVO_EMPLEADO_TITULO" | translate }}
    </h3>
    <form
      #empleadoForm="ngForm"
      (ngSubmit)="guardarEmpleadoNuevo()"
      novalidate
      class="space-y-4"
    >
      <!-- Nombre -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_EMPLEADO_NOMBRE" | translate }}
        </label>
        <input
          type="text"
          name="nombreEmpleadoNuevo"
          [(ngModel)]="empleadoNuevo.nombre"
          #nombreEmpleadoNuevo="ngModel"
          required
          minlength="3"
          placeholder="{{ 'PROFILE.PLACEHOLDER_EMPLEADO_NOMBRE' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
          [ngClass]="{
            'border-red-500': nombreEmpleadoNuevo.invalid && nombreEmpleadoNuevo.touched,
            'border-green-400': nombreEmpleadoNuevo.valid && nombreEmpleadoNuevo.touched
          }"
        />
        <div *ngIf="nombreEmpleadoNuevo.touched && nombreEmpleadoNuevo.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="nombreEmpleadoNuevo.errors?.['required']">
            {{ "PROFILE.ERROR_NOMBRE_REQUIRED" | translate }}
          </div>
          <div *ngIf="nombreEmpleadoNuevo.errors?.['minlength']">
            {{ "PROFILE.ERROR_NOMBRE_MINLENGTH" | translate:{ min: 3 } }}
          </div>
        </div>
      </div>

      <!-- Tel√©fono -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_EMPLEADO_TELEFONO" | translate }}
        </label>
        <input
          type="text"
          name="telefonoEmpleadoNuevo"
          [(ngModel)]="empleadoNuevo.telefono"
          #telefonoEmpleadoNuevo="ngModel"
          required
          pattern="^[0-9]{9}$"
          placeholder="{{ 'PROFILE.PLACEHOLDER_EMPLEADO_TELEFONO' | translate }}"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
          [ngClass]="{
            'border-red-500': telefonoEmpleadoNuevo.invalid && telefonoEmpleadoNuevo.touched,
            'border-green-400': telefonoEmpleadoNuevo.valid && telefonoEmpleadoNuevo.touched
          }"
        />
        <div *ngIf="telefonoEmpleadoNuevo.touched && telefonoEmpleadoNuevo.invalid" class="text-red-600 mt-1 text-sm">
          <div *ngIf="telefonoEmpleadoNuevo.errors?.['required']">
            {{ "PROFILE.ERROR_TELEFONO_REQUIRED" | translate }}
          </div>
          <div *ngIf="telefonoEmpleadoNuevo.errors?.['pattern']">
            {{ "PROFILE.ERROR_TELEFONO_PATTERN" | translate }}
          </div>
        </div>
      </div>

      <!-- Foto -->
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_EMPLEADO_FOTO" | translate }}
        </label>
        <input
          type="file"
          (change)="onFileSelected($event, 'empleado')"
          accept="image/*"
          class="w-full px-4 py-2 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none"
        />
      </div>
      <div *ngIf="previewUrlEmpleado" class="mt-2 text-center">
        <img
          [src]="previewUrlEmpleado"
          alt="{{ 'PROFILE.ALT_EMPLEADO_PREVIEW' | translate }}"
          class="rounded-xl w-full object-cover h-48 max-h-48 shadow-md"
        />
      </div>

      <!-- Botones -->
      <div class="flex justify-end space-x-2 pt-4">
        <button
          type="button"
          class="bg-gray-500 text-white px-4 py-2 rounded"
          (click)="cerrarFormularioEmpleado()"
        >
          {{ "PROFILE.BUTTON_CANCELAR" | translate }}
        </button>
        <button
          type="submit"
          [disabled]="empleadoForm.invalid"
          class="bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50"
        >
          {{ "PROFILE.BUTTON_GUARDAR_EMPLEADO" | translate }}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Formulario emergente para EDITAR EMPLEADO -->
<div
  *ngIf="showFormEditarEmpleado && empleadoEditando"
  class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
>
  <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-lg">
    <h3 class="text-xl font-semibold mb-4">
      {{ "PROFILE.MODAL_EDITAR_EMPLEADO_TITULO" | translate }}
    </h3>
    <form (ngSubmit)="guardarCambiosEmpleado()" class="space-y-4">
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_EMPLEADO_NOMBRE" | translate }}
        </label>
        <input
          type="text"
          [(ngModel)]="empleadoEditando.nombre"
          name="nombreEmpleadoEdit"
          required
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          placeholder="{{ 'PROFILE.PLACEHOLDER_EMPLEADO_NOMBRE' | translate }}"
        />
      </div>
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_EMPLEADO_TELEFONO" | translate }}
        </label>
        <input
          type="text"
          [(ngModel)]="empleadoEditando.telefono"
          name="telefonoEmpleadoEdit"
          required
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
          placeholder="{{
            'PROFILE.PLACEHOLDER_EMPLEADO_TELEFONO' | translate
          }}"
        />
      </div>
      <div>
        <label class="block text-sm font-medium">
          {{ "PROFILE.LABEL_EMPLEADO_FOTO" | translate }}
        </label>
        <input
          type="file"
          (change)="onFileSelected($event, 'empleado')"
          accept="image/*"
          class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-[#117b95] focus:outline-none text-gray-700"
        />
      </div>
      <div *ngIf="previewUrlEmpleado" class="mt-2">
        <img
          [src]="previewUrlEmpleado"
          alt="{{ 'PROFILE.ALT_EMPLEADO_PREVIEW' | translate }}"
          class="w-24 h-24 rounded-full object-cover mx-auto"
        />
      </div>
      <div class="flex justify-end space-x-2 pt-4">
        <button
          type="button"
          class="bg-gray-500 text-white px-4 py-2 rounded"
          (click)="cerrarFormularioEmpleado()"
        >
          {{ "PROFILE.BUTTON_CANCELAR" | translate }}
        </button>
        <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded">
          {{ "PROFILE.BUTTON_ACTUALIZAR_EMPLEADO" | translate }}
        </button>
      </div>
    </form>
  </div>
</div>
